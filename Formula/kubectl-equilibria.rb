# frozen_string_literal: true

require_relative "../lib/registry_download"

class KubectlEquilibria < Formula
  desc "Kubectl plugin for interacting with ACE Equilibria"
  homepage "https://git.act3-ace.com/ace/equilibria"
  version "0.9.6"

  depends_on "kubernetes-cli"

  # Generated by https://git.act3-ace.com/ace/homebrew-ace-tools/-/blob/master/bin/formulize.sh
  on_macos do
    if Hardware::CPU.intel?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:e6609acdf83627ef80e79c717eaf9f75b5dcee8e556dc2c82a884e56913ee223",
          using: BlobDownloadStrategy
      sha256 "e6609acdf83627ef80e79c717eaf9f75b5dcee8e556dc2c82a884e56913ee223"
    end
    if Hardware::CPU.arm?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:a8280a874cd310f60a4bcf7959860029388369417c2fa438bdb925bbdc1503bb",
          using: BlobDownloadStrategy
      sha256 "a8280a874cd310f60a4bcf7959860029388369417c2fa438bdb925bbdc1503bb"
    end
  end

  # Generated by https://git.act3-ace.com/ace/homebrew-ace-tools/-/blob/master/bin/formulize.sh
  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:6a1c82487894a700ebf1031d509eb7fd9ab5f66410cd1302a6674c62f63a68c9",
          using: BlobDownloadStrategy
      sha256 "6a1c82487894a700ebf1031d509eb7fd9ab5f66410cd1302a6674c62f63a68c9"
    end
    if Hardware::CPU.intel?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:2271c879ca663b4a3b9cf09b72804f482c9b0fbfc2a6fc849915c750b624b814",
          using: BlobDownloadStrategy
      sha256 "2271c879ca663b4a3b9cf09b72804f482c9b0fbfc2a6fc849915c750b624b814"
    end
  end

  def install
    bin.install "kubectl-equilibria"
    generate_completions_from_executable(bin/"kubectl-equilibria", "completion")

    # # Generate manpages
    # mkdir "man" do
    #   system bin/"kubectl-equilibria", "gendocs", "man", "."
    #   man1.install Dir["*.1"]
    #   # man5.install Dir["*.5"]
    # end
  end

  test do
    system "#{bin}/kubectl-equilibria", "version"
  end
end
