# frozen_string_literal: true

require_relative "../lib/registry_download"

class KubectlEquilibria < Formula
  desc "Kubectl plugin for interacting with ACE Equilibria"
  homepage "https://git.act3-ace.com/ace/equilibria"
  version "0.9.8"

  depends_on "kubernetes-cli"

  # Generated by https://git.act3-ace.com/ace/homebrew-ace-tools/-/blob/master/bin/formulize.sh
  on_macos do
    if Hardware::CPU.intel?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:eac8e1543e007184a04550ce02039d8dbddb087bafcb2a383986fce916e0efe6",
          using: BlobDownloadStrategy
      sha256 "eac8e1543e007184a04550ce02039d8dbddb087bafcb2a383986fce916e0efe6"
    end
    if Hardware::CPU.arm?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:fa16d94f213431c0ffe661a5327084a6b405401787214043bc9908855e2b20bc",
          using: BlobDownloadStrategy
      sha256 "fa16d94f213431c0ffe661a5327084a6b405401787214043bc9908855e2b20bc"
    end
  end

  # Generated by https://git.act3-ace.com/ace/homebrew-ace-tools/-/blob/master/bin/formulize.sh
  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:f0562285624385331fda4386d6daf0416a9df59f63c0b2504893c04e3f569c83",
          using: BlobDownloadStrategy
      sha256 "f0562285624385331fda4386d6daf0416a9df59f63c0b2504893c04e3f569c83"
    end
    if Hardware::CPU.intel?
      url "reg.git.act3-ace.com/ace/equilibria/releases/kubectl-equilibria@sha256:68a37e4205d5b6fece5a797f2fd1af321ce761adc623fa856ca0b0e388d51e1b",
          using: BlobDownloadStrategy
      sha256 "68a37e4205d5b6fece5a797f2fd1af321ce761adc623fa856ca0b0e388d51e1b"
    end
  end

  def install
    bin.install "kubectl-equilibria"
    generate_completions_from_executable(bin/"kubectl-equilibria", "completion")

    # # Generate manpages
    # mkdir "man" do
    #   system bin/"kubectl-equilibria", "gendocs", "man", "."
    #   man1.install Dir["*.1"]
    #   # man5.install Dir["*.5"]
    # end
  end

  test do
    system "#{bin}/kubectl-equilibria", "version"
  end
end
